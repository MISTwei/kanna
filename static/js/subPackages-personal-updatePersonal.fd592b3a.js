(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["subPackages-personal-updatePersonal"],{"0847":function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 背景颜色 */[data-v-16ba4c44]:root{--uni-bg-color:#4309f1;--uni-btn-bg-color:#2cd30b;--uni-back-color:#e91010}.navigator-hover[data-v-16ba4c44]{background-color:initial!important;opacity:1}.container[data-v-16ba4c44]{padding:%?40?%}.card .title[data-v-16ba4c44]{font-size:%?32?%;width:%?120?%}.card .item[data-v-16ba4c44]{flex:1;display:flex;align-items:center;justify-content:flex-end;height:%?80?%}.card .item .value[data-v-16ba4c44]{font-size:%?32?%}.card .item .icon[data-v-16ba4c44]{margin-left:%?10?%}.card .item .head-img[data-v-16ba4c44]{display:flex;align-items:center}.card .item .head-img .title[data-v-16ba4c44]{width:auto;margin-left:%?30?%}.card .item .head-img uni-image[data-v-16ba4c44]{width:%?120?%;height:%?120?%;border-radius:100%;background:#f9f9f9}.card .headbox[data-v-16ba4c44]{display:flex;align-items:center;justify-content:space-between;height:%?160?%}.header[data-v-16ba4c44]{display:flex;align-items:center;justify-content:space-between;padding:%?20?% 0;border-bottom:1px dashed #dbc6e6}.save-btn[data-v-16ba4c44]{display:flex;align-items:center;justify-content:center;width:%?400?%;height:%?80?%;color:#fff;border-radius:%?8?%;font-size:%?32?%;margin:%?60?% auto}.writeoff[data-v-16ba4c44]{width:100%;text-align:center;margin-top:%?90?%}.writeoff .off-text[data-v-16ba4c44]{color:#888c8f;font-size:%?32?%;text-decoration:underline}.writeoff .mask[data-v-16ba4c44]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center}.writeoff .mask .dialog[data-v-16ba4c44]{width:%?600?%;background:#fff;border-radius:%?20?%;padding:%?30?% %?30?% 0 %?30?%}.writeoff .mask .title[data-v-16ba4c44]{font-size:%?32?%;font-weight:700;text-align:center}.writeoff .mask .content[data-v-16ba4c44]{margin:%?30?% 0;font-size:%?28?%;line-height:%?44?%;text-align:left}.writeoff .mask .btns[data-v-16ba4c44]{display:flex;border-top:1px solid #eee}.writeoff .mask .btn[data-v-16ba4c44]{display:flex;align-items:center;justify-content:center;height:%?80?%;font-size:%?32?%;flex:1}.writeoff .mask .cancel[data-v-16ba4c44]{color:#999}.writeoff .mask .confirm[data-v-16ba4c44]{font-weight:700}.popup-content[data-v-16ba4c44]{width:%?702?%}.popup-content .popup-title[data-v-16ba4c44]{font-size:%?32?%;font-weight:700;color:#000;text-align:center;padding:%?24?% 0}.popup-content .popup-avatar-box[data-v-16ba4c44]{padding:%?24?% %?20?%;height:%?600?%;overflow-y:scroll}.popup-content .popup-avatar-box .list[data-v-16ba4c44]{display:grid;grid-template-columns:repeat(4,1fr);gap:%?20?% %?20?%}.popup-content .popup-avatar-box .popup-avatar-item[data-v-16ba4c44]{display:flex;align-items:center;justify-content:center}.popup-content .popup-avatar-box .popup-avatar-item .popup-avatar-img[data-v-16ba4c44]{position:relative;width:%?120?%;height:%?120?%;text-align:center;border-radius:100%;overflow:hidden}.popup-content .popup-avatar-box .popup-avatar-item .popup-avatar-img uni-image[data-v-16ba4c44]{position:relative;width:100%;height:100%}.popup-content .popup-avatar-box .popup-avatar-item .select[data-v-16ba4c44]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:1;background:hsla(0,0%,100%,.3);border-radius:100%}.popup-content .popup-btn-box[data-v-16ba4c44]{display:flex;justify-content:space-between;padding:%?20?% %?24?%}.popup-content .popup-btn-box .b-btn-cancel[data-v-16ba4c44],\n.popup-content .popup-btn-box .b-btn-affirm[data-v-16ba4c44]{display:flex;align-items:center;justify-content:center;width:48%;height:%?80?%;border-radius:%?8?%;font-size:%?32?%;color:#fff}.popup-content .popup-btn-box .b-btn-cancel[data-v-16ba4c44]{background:#f9f9f9;color:#333}[data-v-16ba4c44] .u-input__content__field-wrapper__field{font-size:%?32?%!important}',""]),t.exports=e},"0fcc":function(t,e,i){"use strict";i.r(e);var a=i("fcf9"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},"16a2":function(t,e,i){var a=i("0847");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("967d").default;n("3fdefbd7",a,!0,{sourceMap:!1,shadowMode:!1})},2360:function(t,e,i){"use strict";i.r(e);var a=i("74bf"),n=i("43a8");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);var s=i("828b"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"06a96356",null,!1,a["a"],void 0);e["default"]=c.exports},"43a8":function(t,e,i){"use strict";i.r(e);var a=i("b60d"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},"4ce7":function(t,e,i){"use strict";var a=i("16a2"),n=i.n(a);n.a},"5b15":function(t,e,i){"use strict";i.r(e);var a=i("b924"),n=i("0fcc");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("4ce7");var s=i("828b"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"16ba4c44",null,!1,a["a"],void 0);e["default"]=c.exports},"74bf":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{style:{height:t.contentHeight+"px",width:t.contentWidth+"px"}},[t.canvasId?i("v-uni-canvas",{style:{height:t.contentHeight+"px",width:t.contentWidth+"px"},attrs:{id:t.canvasId,canvasId:t.canvasId,width:t.contentWidth,height:t.contentHeight},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.drawTap.apply(void 0,arguments)}}}):t._e()],1)},n=[]},b60d:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("64aa"),i("cf80");var a={name:"qiao-verification",props:{value:{type:String,default:""},modelValue:{type:String,default:""},securityCode:{type:String,default:""},codeLength:{type:Number,default:4},contentWidth:{type:Number,default:120},contentHeight:{type:Number,default:60},lineLength:{type:Number,default:8},backgroundColor:{type:String,default:"rgb(238,226,224)"},lineColorList:{type:Array,default:function(){return["rgba(238,0,0,.5)","rgba(0, 170, 255,.5)","rgba(0, 170, 0,.5)","rgba(0, 0, 0,.5)","rgba(153, 146, 255,.5)"]}},colorList:{type:Array,default:function(){return["rgb(238,0,0)","rgb(0, 170, 255)","rgb(0, 170, 0)","rgb(0, 0, 0)","rgb(153, 146, 255)"]}},isCaseCheck:{type:Boolean,default:!0}},computed:{canvasId:function(){return"lime-signature".concat(this._uid)}},data:function(){return{identifyCode:""}},watch:{securityCode:function(){this.drawPic()},identifyCode:function(t,e){this.$emit("input",t)}},methods:{verification:function(t){return this.isCaseCheck?this.identifyCode==t:this.identifyCode.toLowerCase()==t.toLowerCase()},gainCode:function(){return this.identifyCode},randomNum:function(t,e){return Math.floor(Math.random()*(e-t)+t)},getCheckCode:function(){for(var t="",e=this.codeLength,i=[1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z"],a=0;a<e;a++){var n=Math.floor(34*Math.random());t+=i[n]}this.identifyCode=t},drawTap:function(){this.securityCode?this.$emit("getCode"):this.drawPic()},drawPic:function(){this.securityCode?this.identifyCode=this.securityCode:this.getCheckCode();var t=uni.createCanvasContext(this.canvasId,this);t.setTextBaseline("bottom"),t.setFillStyle(this.backgroundColor),t.fillRect(0,0,this.contentWidth,this.contentHeight);for(var e=0;e<this.identifyCode.length;e++)this.drawText(t,this.identifyCode[e],e);this.drawLine(t),t.draw()},drawText:function(t,e,i){var a=Math.floor(Math.random()*this.colorList.length);t.setFillStyle(this.colorList[a]);var n=Math.trunc(this.contentWidth/this.identifyCode.length);t.setFontSize(this.randomNum(n,n));var o=i*(this.contentWidth/(this.identifyCode.length+1))+Math.trunc(n/2),s=this.randomNum(n,this.contentHeight-5),c=this.randomNum(-10,10);t.translate(o,s),t.rotate(c*Math.PI/180),t.fillText(e,0,0),t.rotate(-c*Math.PI/180),t.translate(-o,-s)},drawLine:function(t){for(var e=0;e<this.lineLength;e++){var i=Math.floor(Math.random()*this.lineColorList.length);t.setStrokeStyle(this.lineColorList[i]),t.beginPath();var a=this.randomNum(0,this.contentWidth),n=this.randomNum(0,this.contentHeight),o=this.randomNum(0,this.contentWidth),s=this.randomNum(0,this.contentHeight);t.moveTo(a,n),t.lineTo(o,s),t.stroke()}}},mounted:function(){this.drawPic()}};e.default=a},b924:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var a={uIcon:i("aa82").default,uInput:i("ec47").default,uPopup:i("aefd").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{attrs:{hideFooter:!0}},[i("nav-back",[i("v-uni-view",{staticClass:"nav-title",style:{color:t.$theme.text}},[t._v("修改个人信息")])],1),i("loding",{attrs:{isShow:t.loding}}),i("v-uni-view",{staticClass:"container"},[i("v-uni-view",{staticClass:"card"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-view",{staticClass:"item headbox",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseAvatar.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"head-img"},[i("v-uni-image",{attrs:{src:t.avatar,mode:"aspectFit"}}),i("v-uni-text",{staticClass:"title"},[t._v("更换头像")])],1),i("u-icon",{attrs:{name:"edit-pen-fill",color:t.$theme.text,size:"48"}})],1)],1)],1),i("v-uni-view",{staticClass:"card"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-text",{staticClass:"title"},[t._v("昵称")]),i("v-uni-view",{staticClass:"item"},[t.isEditing.nickname?i("u-input",{attrs:{placeholder:"请输入昵称",focus:t.isEditing.nickname,customStyle:{height:"48rpx"}},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.saveField("nickname")}},model:{value:t.nicknameInput,callback:function(e){t.nicknameInput=e},expression:"nicknameInput"}}):i("v-uni-text",{staticClass:"value"},[t._v(t._s(t.nickname))]),t.isEditing.nickname?t._e():i("v-uni-view",{staticClass:"icon",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editField("nickname")}}},[i("u-icon",{attrs:{name:"edit-pen-fill",color:t.$theme.text,size:"48"}})],1)],1)],1)],1),i("v-uni-view",{staticClass:"card"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-text",{staticClass:"title"},[t._v("手机号")]),i("v-uni-view",{staticClass:"item"},[t.isEditing.phone?t._e():i("v-uni-text",{staticClass:"value"},[t._v(t._s(t.phone))])],1)],1)],1),i("v-uni-view",{staticClass:"card"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-text",{staticClass:"title"},[t._v("邮箱")]),i("v-uni-view",{staticClass:"item"},[t.isEditing.email?i("u-input",{attrs:{placeholder:"请输入邮箱",focus:t.isEditing.email,customStyle:{height:"48rpx"}},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.saveField("email")}},model:{value:t.emailInput,callback:function(e){t.emailInput=e},expression:"emailInput"}}):i("v-uni-text",{staticClass:"value"},[t._v(t._s(t.email))]),t.isEditing.email?t._e():i("v-uni-view",{staticClass:"icon",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editField("email")}}},[i("u-icon",{attrs:{name:"edit-pen-fill",color:t.$theme.text,size:"48"}})],1)],1)],1)],1),t._e(),i("v-uni-view",{staticClass:"save-btn",style:{background:t.$theme.btn},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveChanges.apply(void 0,arguments)}}},[t._v("保 存")]),i("v-uni-view",{staticClass:"writeoff"},[i("v-uni-view",{staticClass:"off-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showOff=!0}}},[t._v("注销账号")]),t.showOff?i("v-uni-view",{staticClass:"mask"},[i("v-uni-view",{staticClass:"dialog"},[i("v-uni-view",{staticClass:"title"},[t._v("注销账户确认")]),i("v-uni-view",{staticClass:"content"},[t._v(" 账户注销后您的所有权益和信息将被删除，确认注销该账号？ ")]),i("v-uni-view",{staticClass:"btns"},[i("v-uni-view",{staticClass:"btn cancel",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showOff=!1}}},[t._v("取消")]),i("v-uni-view",{staticClass:"btn confirm",style:{color:t.$theme.btn},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteAccount.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)],1),i("u-popup",{attrs:{show:t.headImagePopup,mode:"center",round:10}},[i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"popup-title"},[t._v("选择头像")]),i("v-uni-view",{staticClass:"popup-avatar-box",style:{background:t.$theme.bg}},[i("v-uni-view",{staticClass:"list"},t._l(t.headList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"popup-avatar-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.selectHeadImage(e)}}},[i("v-uni-view",{staticClass:"popup-avatar-img",style:{border:"1.5px solid "+(t.headImage==e?t.$theme.btn:"#ffffff")}},[i("v-uni-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e,mode:"aspectFit"}}),t.headImage==e?i("v-uni-view",{staticClass:"select"},[i("u-icon",{attrs:{name:"checkbox-mark",size:"48",color:t.$theme.btn}})],1):t._e()],1)],1)})),1)],1),i("v-uni-view",{staticClass:"popup-btn-box"},[i("v-uni-view",{staticClass:"b-btn-cancel",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.headImagePopup=!1,t.$store.state.fixedLayout=!1}}},[t._v("取消 ")]),i("v-uni-view",{staticClass:"b-btn-affirm",style:{border:"1px solid"+t.$theme.bg,background:t.$theme.btn},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ConfirmSelection.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1)],1)},o=[]},cf80:function(t,e,i){"use strict";var a=i("8bdb"),n=i("1aad");a({target:"Math",stat:!0},{trunc:n})},fcf9:function(t,e,i){"use strict";(function(t){i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c9b5"),i("bf0f"),i("ab80");var n=a(i("9b1b")),o=(i("1922"),i("3c08")),s=i("8f59"),c=a(i("2360")),r={components:{qiaoVerification:c.default},data:function(){return{code:"",securityCode:"",showOff:!1,headImagePopup:!1,avatar:"",avatarId:"",nickname:"",phone:"",email:"",password:"",nicknameInput:"",phoneInput:"",emailInput:"",passwordInput:"",isEditing:{nickname:!1,phone:!1,email:!1,password:!1},headList:[],headImage:""}},created:function(){this.getHeadList(),this.getInit()},methods:(0,n.default)((0,n.default)({},(0,s.mapActions)(["updateUserInfo"])),{},{getCode:function(){this.securityCode=Math.random().toString().substr(2,40)},getInit:function(){var t=this;this.loding=!0,this.$get("api/customers/info").then((function(e){200==e.code&&(t.avatar=e.data.avatar,t.nickname=e.data.nickname,t.phone=e.data.phone,t.email=e.data.email,t.headImage=e.data.avatar)})).finally((function(){t.loding=!1}))},getHeadList:function(){var t=this;this.$get("api/obs/avatar").then((function(e){200==e.code&&(t.headList=e.data)})).finally((function(){t.loding=!1}))},selectHeadImage:function(t){this.headImage=t},ConfirmSelection:function(){this.avatar=this.headImage,this.headImagePopup=!1},deleteAccount:function(){var t=this;this.$post("api/customers/cancel").then((function(e){200==e.code&&(t.showOff=!1,uni.showToast("注销成功"),t.$store.dispatch("logout"),setTimeout((function(){uni.reLaunch({url:"/subPackages/personal/login"})}),1e3))}))},chooseAvatar:function(){return this.headImagePopup=!0,!1},editField:function(t){this.isEditing[t]=!0,this["".concat(t,"Input")]=this[t]},saveField:function(t){this[t]=this["".concat(t,"Input")],this.isEditing[t]=!1},saveChanges:function(){var t=this;if(this.avatar)if((0,o.isEmptyOrNull)(this.nickname))uni.showToast({title:"请填写昵称",icon:"none"});else if((0,o.isEmptyOrNull)(this.phone))uni.showToast({title:"请填写手机号",icon:"none"});else if((0,o.isEmptyOrNull)(this.email))uni.showToast({title:"请填写邮箱",icon:"none"});else{var e={avatar:this.avatar,nickname:this.nickname,phone:this.phone,email:this.email};this.$post("api/customers/info/update",e).then((function(e){if(200==e.code){var i=uni.getStorageSync("userInfo");i.avatar=t.avatar,t.updateUserInfo(i),uni.showToast({title:"保存成功",icon:"success"})}}))}else uni.showToast({title:"请选择头像",icon:"none"})}})};e.default=r}).call(this,i("ba7c")["default"])}}]);